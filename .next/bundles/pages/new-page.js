module.exports=__NEXT_REGISTER_PAGE("/new-page",function(){return{page:webpackJsonp([9],{25:function(e,t,n){"use strict";var r=n(4),a=(n.n(r),r.allowedExts.images),o=r.allowedExts.other,i=Math.floor(r.maxFileSize/1e6)+"MB",l=function(e){return{error:e}};t.a=function(e){var t=e.file,n=e.customExtension,c=e.imageOnly,u=e.previewCb,s=t.name;if(t.size>r.maxFileSize)return l("File exceeds max file size of ".concat(i));if(s.indexOf(".")<0)return l("File name does not contain a file extension (e.g. .jpg, .png)");var d=s.split(".").pop().toLowerCase();if(n)return l(d===n?null:"File type is invalid. Expected .".concat(n));var f=a.indexOf(d)>-1;if(!f&&c||!f&&o.indexOf(d)<0)return function(e){var t=e?a:a.concat(o);return l("File type is invalid. Allowed types are ".concat(t.join(", "),"."))}(c);if(f&&"function"==typeof u){var m=new FileReader;m.onload=function(e){u(e.target.result)},m.readAsDataURL(t)}return{error:null}}},42:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(10),i=(n.n(o),n(2)),l=(n.n(i),n(25)),c=n(1),u=n(3),s=n(15);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={padding:10,width:"100%",minHeight:80,overflow:"hidden",position:"relative",maxWidth:u.sizes.maxBlockWidth,border:"1px dotted ".concat(u.colors.blackFg),"& .select":b({},u.flexColCenter,{textAlign:"center",justifyContent:"center","& input":{display:"none"},"& button":{margin:10}}),"& .eatAnim":{width:60,height:60,position:"absolute",transform:"rotate(-30deg)",animation:"".concat(Object(s.b)(60)," 2.5s ease-in-out infinite"),"& .half":{width:60,height:30,overflow:"hidden",textAlign:"center","& div":{width:60,height:60,borderRadius:60,background:u.colors.yellow},":nth-child(1)":{position:"relative",animation:"".concat(s.c," 600ms ease-in-out infinite"),"& i":{top:10,left:24,width:8,height:8,borderRadius:8,background:"black",position:"absolute"}},":nth-child(2)":{animation:"".concat(s.a," 600ms ease-in-out infinite")}}}},y=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=(t.__proto__||Object.getPrototypeOf(t)).call(this),e=!r||"object"!==d(r)&&"function"!=typeof r?p(n):r,Object.defineProperty(p(e),"doFileCheck",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=e.props,r=n.checkFileParams,a=n.onFileChange;if(t){var o=Object(l.a)(b({},r,{file:t}));if(o.error)return Object(c._88)({title:"Error...",message:o.error,button1Txt:"OK",button2Txt:null})}"function"==typeof a&&a(t)}}),Object.defineProperty(p(e),"handleChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.target.files,r=n.length?n[0]:null;e.doFileCheck(r)}}),Object.defineProperty(p(e),"handleDrop",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({fileIncoming:!1});var n=t.dataTransfer.files;n.length&&(e.doFileCheck(n[0]),t.preventDefault())}}),Object.defineProperty(p(e),"handleDragOver",{configurable:!0,enumerable:!0,writable:!0,value:function(t){t.preventDefault(),clearTimeout(e.timeout),e.setState({fileIncoming:!0})}}),Object.defineProperty(p(e),"handleDragLeave",{configurable:!0,enumerable:!0,writable:!0,value:function(){clearTimeout(e.timeout),e.timeout=setTimeout(function(){e.setState({fileIncoming:!1})},100)}}),Object.defineProperty(p(e),"focusInput",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.fileEl&&e.fileEl.click()}}),e.state={fileIncoming:!1},e.className=Object(i.css)(h),e}var n,o,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,(o=[{key:"render",value:function(){var e=this,t=this.state.fileIncoming,n=this.props,r=n.style,o=n.message;return o=o||"Drag and drop file or click below to select",a.a.createElement("div",f({style:r},{className:this.className,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave}),t?a.a.createElement("div",{className:"eatAnim"},a.a.createElement("div",{className:"half"},a.a.createElement("div",null,a.a.createElement("i",null))),a.a.createElement("div",{className:"half"},a.a.createElement("div",null))):a.a.createElement("div",{className:"select"},a.a.createElement("p",null,t?"incoming!!!!":o),a.a.createElement("input",{type:"file",onChange:this.handleChange,ref:function(t){return e.fileEl=t}}),a.a.createElement("button",{onClick:this.focusInput},"Select file")))}}])&&m(n.prototype,o),u&&m(n,u),t}();t.a=y},503:function(e,t,n){e.exports=n(504)},504:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n.n(r),o=n(6),i=n(18),l=n(82);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,(o=[{key:"render",value:function(){var e=this.props.users,t=(e[e.curUser]||{}).restricts;return a.a.createElement(i.a,{restrict:!0},a.a.createElement("h4",{style:{padding:"10px 10px 0"}},"Create page"),t&&t.making_pages?a.a.createElement("p",{style:{padding:10}},"Making pages is disabled for your account."):a.a.createElement(l.a,{curPage:"new"}))}}])&&u(n.prototype,o),c&&u(n,c),t}();t.default=Object(o.b)(function(e){return{users:e.users}})(d)},82:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(2),i=n(6),l=n(1),c=n(24),u=n.n(c),s=n(13),d=n(22),f=n(7),m=function(e){var t=e.mods,n=e.users,r=e.newMod,o=e.addMod,i=e.modError,l=e.handleMod,c=e.removeMod,u=e.modPending;return a.a.createElement("div",{className:"mods"},a.a.createElement("div",{className:"wrap"},a.a.createElement("h5",null,"Page moderators"),a.a.createElement("p",{className:"note"},"Note: moderators are allowed to edit the page's name, desc, and thumbnail and post on the page."),a.a.createElement("div",{className:"items"},(!t||!t.length)&&a.a.createElement("p",{className:"none"},"No moderators have been added yet"),t&&t.map(function(e){var t=e._id,r=e.user,o=n[r]||{},i=o.avatar,l=o.firstName,u=o.lastName,s=o.username;return a.a.createElement("div",{key:t},a.a.createElement(d.a,{avatar:i,style:{height:30,width:30}}),a.a.createElement("p",null,"".concat(l," ").concat(u," - @").concat(s)),a.a.createElement(f.a,{id:t,"data-user":r,icon:"trash",style:{height:18},onClick:c}))})),a.a.createElement("div",{className:"addMod"},a.a.createElement("label",{htmlFor:"modUser"},"New moderator: "),a.a.createElement("input",{type:"text",id:"modUser",value:r,onChange:l,placeholder:"New mod's username"}),a.a.createElement("button",{onClick:u?null:o},u?a.a.createElement(s.a,{size:18,alt:!0}):"Submit"),i&&a.a.createElement("p",null,i))))},p=n(59),b=n(3);function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){h(e,t,n[t])})}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y={padding:10,"& .denied":{padding:10,textAlign:"center"},"& .wrapDel":{textAlign:"right",paddingTop:5},"& .fields, & .mods":{width:"100%",margin:"15px auto",maxWidth:b.sizes.maxBlockWidth+130},"& .fields":g({margin:"30px auto"},b.flexRowCenter,{flexWrap:"wrap","& img":{margin:"15px 30px 0 0",alignSelf:"flex-start"},"& .field":g({width:"100%",marginTop:15},b.flexRowCenter,{alignItems:"flex-start","& label":{margin:"5px 5px 0 0"},"& input, & textarea":{padding:5,flexGrow:1,minWidth:175,maxWidth:275,border:"none",background:"transparent",transition:"border-color 150ms ease",borderBottom:"1px solid ".concat(b.colors.blackFg)},"&.btns":g({},b.flexRowCenter,{"& button":{":nth-child(1)":{margin:"0 10px 0 auto"}}})})}),"& .mods":{"& .wrap":{maxWidth:b.sizes.maxBlockWidth},"& .note":{fontSize:14,marginTop:2,maxWidth:"80%"},"& .items":{margin:"15px 0","& .none":{textAlign:"center"},"& div":g({width:"100%"},b.flexRowCenter,{alignItems:"flex-start","& p":{flexGrow:1,padding:"2px 0 0 5px"},"& svg":{cursor:"pointer"}})},"& .addMod":g({},b.flexRowCenter,{flexWrap:"wrap","& label":{marginRight:5},"& input":{padding:5,flexGrow:1,flexShrink:1,minWidth:175,border:"none",background:"none",borderBottom:"1px solid ".concat(b.colors.blackFg)},"& button":{marginLeft:10},"& p":{marginTop:10}})}},v=n(11),w=n(42);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var S=function(e){var t=e.label,n=e.name,r=e.type,o=P(e,["label","name","type"]);return a.a.createElement("div",{className:"field"},t&&a.a.createElement("label",{htmlFor:n},t),a.a.createElement("textarea"===r?"textarea":"input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){x(e,t,n[t])})}return e}({name:n,id:n,type:"textarea"!==r?r:null},o)))},k={name:"",desc:"",thumb:null},_=function(e){var t=e.curPage,n=e.pages;return"new"!==t&&n[t]?n[t]:k},C=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(a=(t.__proto__||Object.getPrototypeOf(t)).call(this,e))||"object"!==O(a)&&"function"!=typeof a?j(r):a,N.call(j(n));var i=_(e),l=i.name,c=i.desc,u=i.thumb;return n.state={name:l,desc:c,thumb:u,newMod:"",file:null,changed:{},modError:null,modPending:!1,previewData:null},n.className=Object(o.css)(y),n}var n,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,l=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.curPage,r=e.page,a=e.pages;if(!r.error&&!r.pending&&t.pending){var o=a[n]||{name:"",desc:""};return{name:o.name,desc:o.desc,changed:{},pending:r.pending}}return r.pending!==t.pending?{pending:r.pending}:null}}],(i=[{key:"render",value:function(){var e,t=this.state,n=t.desc,r=t.name,o=t.newMod,i=t.changed,l=t.modError,c=t.modPending,u=t.previewData,s=this.props,d=s.canEdit,b=s.curPage,g=s.page,h=s.pages,y=s.users,v=(y[y.curUser]||{}).isAdmin,O=g.error,E=g.pending,j=g.progress,x=h[b]||{},k=x.mods,_=x.modsOnly,C=x.thumb,N=P(x,["mods","modsOnly","thumb"]),D="new"===b,T=Object.keys(i).length;return b===h.curPage||D?d||D?(e=u?a.a.createElement(p.a,{src:u}):D?a.a.createElement(f.a,{icon:"file",style:{height:86,width:96,marginRight:25}}):a.a.createElement(p.a,{_id:h.curPage,thumb:C}),a.a.createElement("div",{className:this.className},v&&!N.default&&!D&&a.a.createElement("div",{className:"wrapDel"},a.a.createElement("button",{id:"delete",onClick:this.delete},"Delete page")),a.a.createElement("div",{className:"fields"},e,a.a.createElement(w.a,{style:{margin:"10px 0"},onFileChange:this.handleFileChange,checkFileParams:{imageOnly:!0,previewCb:this.previewThumb},message:"Drag and drop picture or click below to select page thumbnail"}),a.a.createElement(S,{name:"name",value:r,label:"Page name:",onChange:this.handleField,placeholder:"A name for the page"}),a.a.createElement(S,{name:"desc",value:n,type:"textarea",label:"Page description:",onChange:this.handleField,placeholder:"A description of the page"}),Boolean(D&&i.thumb&&i.name||!D&&T)&&a.a.createElement("div",{className:"field btns"},a.a.createElement("button",{onClick:this.reset,className:"btn-alt"},"Reset"),a.a.createElement("button",{onClick:E?null:this.submit},E?"".concat(j,"%"):"Submit")),O&&a.a.createElement("p",{className:"error"},O)),!D&&_&&v&&a.a.createElement(m,{mods:k,users:y,newMod:o,modError:l,modPending:c,addMod:this.addMod,handleMod:this.handleMod,removeMod:this.removeMod}))):a.a.createElement("div",{className:this.className},a.a.createElement("p",{className:"denied"},"You are not allowed to edit this page")):null}}])&&E(n.prototype,i),l&&E(n,l),t}(),N=function(){var e=this;Object.defineProperty(this,"handleFileChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n={changed:e.state.changed,file:t};t?n.changed.thumb=!0:(delete n.changed.thumb,n.previewData=null),e.setState(n)}}),Object.defineProperty(this,"handleField",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n,r=e.state.changed,a=t.target,o=a.name,i=a.value;i!==_(e.props)[o]?r[o]=!0:delete r[o],e.setState((x(n={},o,i),x(n,"changed",r),n))}}),Object.defineProperty(this,"reset",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=_(e.props),n=t.name,r=t.desc;e.setState({name:n,desc:r,file:null,changed:{},previewData:null})}}),Object.defineProperty(this,"submit",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.props.curPage,n=e.state,r=n.changed,a=n.file,o=n.name,i="new"===t;if(!i||o&&a){var c={},s=Object.keys(r);s.length&&(s.forEach(function(t){return c[t]=e.state[t]}),r.thumb&&(c.thumb=a,delete c.file),i||(c._id=t),Object(l._88)({message:"Are you sure you would like to ".concat(i?"create":"update"," this page?"),button1Act:function(){Object(l._93)(c).then(function(e){return u.a.push("/page?id="+e)})}}))}}}),Object.defineProperty(this,"previewThumb",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({previewData:t})}}),Object.defineProperty(this,"handleMod",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({newMod:t.target.value})}}),Object.defineProperty(this,"addMod",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.state,n=t.newMod;t.modPending||(n=n.trim())&&Object(l._88)({message:"Are you sure you want to make ".concat(n," a moderator on this page?"),button1Act:function(){e.setState({modPending:!0,modError:null}),Object(l._34)(n).then(function(){e.setState({modPending:!1,newMod:""})}).catch(function(t){e.unmounted||e.setState({modPending:!1,modError:Object(v.a)(t,"An error occurred adding the mod")})})}})}}),Object.defineProperty(this,"removeMod",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.currentTarget,r=e.props.users,a=n.id,o=r[n.getAttribute("data-user")].username;Object(l._88)({message:"Are you sure you want to remove ".concat(o," as a moderator?"),button1Act:function(){Object(l._78)(a).catch(function(e){Object(l._88)({title:"Error...",message:Object(v.a)(e,"An error occurred removing the moderator"),button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(this,"delete",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.props.curPage;Object(l._88)({message:"Are you sure you want to delete this page? This will delete all posts too and is permanent.",button1Act:function(){Object(l._81)(t).then(function(){return u.a.push("/page")}).catch(function(e){Object(l._88)({title:"Error...",message:Object(v.a)(e,"An error occurred removing the page"),button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(this,"componentWillUnmount",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.unmounted=!0}})};t.a=Object(i.b)(function(e){return{page:e.page,pages:e.pages,users:e.users}})(C)}},[503]).default}});