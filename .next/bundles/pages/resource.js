module.exports=__NEXT_REGISTER_PAGE("/resource",function(){return{page:webpackJsonp([13],{147:function(e,t,n){"use strict";var r=n(0),o=n.n(r),a=n(2),i=(n.n(a),n(3)),c=n(24),l=n.n(c),u=n(15);function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){f(e,t,n[t])})}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=s({padding:10,width:"100%",maxWidth:675,margin:"auto"},i.flexRowCenter,{flexWrap:"wrap",justifyContent:"center","& a":s({zIndex:1,margin:10,width:135,height:135,padding:"0 4px"},i.shadows.box,i.flexRowCenter,f({textAlign:"center",borderRadius:"100%",background:"#ffffff",display:"inline-flex",textDecoration:"none",justifyContent:"center",border:"2px solid transparent",transition:"\n      border-color 145ms ease-in-out, \n      left 325ms ease-in-out, \n      top 325ms ease-in-out\n    ","&.active":{zIndex:2,position:"relative",transition:"margin",transitionDelay:"160ms","& p":s({zIndex:2,color:"#ffffff"},i.shadows.text),"&:before":{content:'""',position:"absolute",top:-3,left:-3,right:0,zIndex:1,bottom:0,width:140,height:140,margin:"auto",borderRadius:"100%",background:i.colors.blueGradient,animation:"".concat(u.f," 160ms ease-in-out")}},":hover":{borderColor:i.colors.blueMix}},i.media.lessThan(330),{width:110,height:110,"&.active:before":{height:115,width:115}}))}),b=function(e){e.preventDefault();var t=e.currentTarget;t.classList.add("active");var n=t.offsetLeft,r=t.offsetTop,o=document.getElementById("bubbles"),a=o.offsetHeight,i=o.offsetWidth;o.style.height=a+"px",o.style.width=i+"px";for(var c=document.getElementsByClassName("bubble"),u=[],s=0;s<c.length;s++){var f=c[s].offsetTop-10.5,p=c[s].offsetLeft-10.5;u.push({left:p,top:f})}for(var b=0;b<c.length;b++)c[b].style.position="absolute",c[b].style.top=u[b].top+"px",c[b].style.left=u[b].left+"px";setTimeout(function(){for(var e=0;e<c.length;e++)c[e].style.top=r+"px",c[e].style.left=n+"px";setTimeout(function(){return l.a.push(t.href)},500)},50)};t.a=function(e){var t=e.items,n=void 0===t?[]:t,r=e.rowCount,i=void 0===r?0:r;return o.a.createElement("div",{id:"bubbles",className:Object(a.css)(p),style:{maxWidth:i?140*(i+1):null}},n.map(function(e,t){var n=e.label,r=e.link;return o.a.createElement("a",{id:t,key:r,href:r,onClick:b,className:"bubble"},o.a.createElement("p",null,n))}))}},511:function(e,t,n){e.exports=n(512)},512:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),o=n.n(r),a=n(0),i=n.n(a),c=n(2),l=n(6),u=n(1),s=n(16),f=n.n(s),p=n(18),b=n(13),d=n(147),m=n(37),h=n(3),g=n(11),y=n(7);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var O=function(e){var t=e.id,n=e.label,r=e.link,o=e.noIcons,a=e.changed,c=e.delAct,l=e.resetAct,u=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["id","label","link","noIcons","changed","delAct","resetAct"]);return i.a.createElement("div",{className:"row"},!o&&i.a.createElement("div",null,a&&i.a.createElement("span",{title:"reset changes"},i.a.createElement(y.a,v({icon:"undo"},{id:t},{onClick:l,style:{height:14}}))),i.a.createElement(y.a,v({icon:"trash",style:{height:14}},{id:t},{onClick:c}))),i.a.createElement("input",v({},u,{type:"text",value:n,maxLength:"24",id:"label:".concat(t),style:{marginRight:10},placeholder:"Resource label"})),i.a.createElement("input",v({},u,{type:"url",value:r,maxLength:"1024",id:"link:".concat(t),placeholder:"Resource link"})))};function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){x(e,t,n[t])})}return e}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _={padding:10,"& .row":{margin:"15px auto 0","& div":{textAlign:"right",padding:"0 10px 0 0","& svg":{cursor:"pointer",marginLeft:5}},"& input":{padding:5,border:"none",background:"none",width:"calc(50% - 10px)",borderBottom:"1px solid ".concat(h.colors.blackFg)}},"& .row, & .wrapBtn":{width:"100%",maxWidth:1.5*h.sizes.maxBlockWidth},"& .wrapBtn":{margin:"auto",textAlign:"right",padding:"10px 10px 0 0"},"& .addItem":{margin:"50px 0 20px"}},S=function(e){function t(e){var n,r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(o=(t.__proto__||Object.getPrototypeOf(t)).call(this,e))||"object"!==w(o)&&"function"!=typeof o?P(r):o,A.call(P(n));var a={new:{link:"",label:""}},i=e.resources;return i.ids.forEach(function(e){return a[e]={label:i[e].label,link:i[e].link}}),n.state=a,n.className=Object(c.css)(_),n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["Component"]),n=t,o=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.resources,r={},o=!1;return n.ids.forEach(function(e){t[e]||(o=!0,r[e]=j({},n[e]))}),o?r:null}}],(r=[{key:"render",value:function(){var e=this,t=this.state,n=t.newLabel,r=t.newLink,o=this.props.resources.ids;return i.a.createElement("div",{className:this.className},i.a.createElement("div",{className:"wrapItems"},o.map(function(t){var n=e.state[t],r=n.label,o=n.link,a=n.changed;return i.a.createElement(O,E({id:t,changed:a,label:r,link:o},{key:t,delAct:e.delResource,onChange:e.handleChange,resetAct:e.resetResource}))}),i.a.createElement("div",{className:"wrapBtn"},i.a.createElement("button",{onClick:this.submitChanges},"Submit changes"))),i.a.createElement("div",{className:"addItem"},i.a.createElement(O,{id:"new",noIcons:!0,link:r,label:n,onChange:this.handleChange}),i.a.createElement("div",{className:"wrapBtn"},i.a.createElement("button",{onClick:this.addResource},"Add resource"))))}}])&&k(n.prototype,r),o&&k(n,o),t}(),A=function(){var e=this;Object.defineProperty(this,"handleChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.target.id,r=n.split(":");n=r.pop();var o=r.pop(),a=t.target.value,i=Boolean("new"!==n&&a!==e.props.resources[n][o]);e.setState(x({},n,j({},e.state[n],x({changed:i},o,a))))}}),Object.defineProperty(this,"resetResource",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.currentTarget.id;e.setState(x({},n,j({},e.props.resources[n],{changed:!1})))}}),Object.defineProperty(this,"addResource",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.state.new||{},n=t.label,r=t.link;n&&r&&Object(u._88)({message:"Are you sure you want to add this resource?",button1Act:function(){Object(u._38)({label:n,link:r}).catch(function(e){Object(u._88)({title:"Error...",message:Object(g.a)(e,"An error occurred adding the resource"),button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(this,"delResource",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=e.props.resources,r=t.currentTarget.id;Object(u._88)({message:"Are you sure you want to delete the ".concat(n[r].label," resource?"),button1Act:function(){Object(u._83)(r).catch(function(e){Object(u._88)({title:"Error...",message:Object(g.a)(e,"An error occurred deleting the resource"),button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(this,"updateOne",{configurable:!0,enumerable:!0,writable:!0,value:function(t){if(!t.length)return Promise.resolve();var n=t.pop(),r=e.state[n],o=r.link,a=r.label;return Object(u._95)({_id:n,label:a,link:o}).then(function(){return e.setState(x({},n,{link:o,label:a,changed:!1}))}).then(function(){return e.updateOne(t)}).catch(function(e){Object(u._88)({title:"Error...",message:Object(g.a)(e,"An error occurred submitting the changes"),button1Txt:"OK",button2Txt:null})})}}),Object.defineProperty(this,"submitChanges",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=Object.keys(e.state).filter(function(t){var n=e.state[t],r=n.changed,o=n.link,a=n.label;return r&&o.length&&a.length&&"new"!==t});if(t.length){var n=t.length,r=1===n?"":"s";Object(u._88)({message:"Are you sure you want to update ".concat(n," resource").concat(r,"?"),button1Act:function(){return e.updateOne(t)}})}}})},C=Object(l.b)(function(e){return{resources:e.resources}})(S);function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){return!t||"object"!==N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),e}var B={position:"relative",paddingBottom:20,"& .error":{textAlign:"center",padding:"35px 10px"},"& .loading":{top:0,left:0,right:0,bottom:0,zIndex:1,margin:"auto",position:"absolute"},"& iframe":{top:0,left:0,zIndex:2,width:"100%",height:"100%",border:"none",position:"absolute"},"& .wrapEdit":{padding:10,width:"100%",paddingBottom:0,textAlign:"right"}},z=function(e){var t,n;function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=T(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e))).className=Object(c.css)(B),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,a["Component"]),I(r,null,[{key:"getInitialProps",value:(t=o.a.mark(function e(t){var n,r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query,r={},n.id?r.active=n.id:void 0!==n.edit&&(r.editMode=!0),e.next=5,Object(u._52)();case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}),n=function(){var e=this,n=arguments;return new Promise(function(r,o){var a=t.apply(e,n);function i(e,t){try{var n=a[e](t),i=n.value}catch(e){return void o(e)}n.done?r(i):Promise.resolve(i).then(c,l)}function c(e){i("next",e)}function l(e){i("throw",e)}c()})},function(e){return n.apply(this,arguments)})}]),I(r,[{key:"render",value:function(){var e=this.props,t=e.active,n=e.editMode,r=e.resources,o=e.users,a=(o[o.curUser]||{}).isAdmin,c=r.error,l=r.ids,u=r.pending,s=Boolean(r[t]);return i.a.createElement(p.a,{className:this.className,restrict:!0},n&&a&&i.a.createElement(C,null),n&&!a&&i.a.createElement("p",{className:"error"},"You do not have permission to access this"),t&&s&&i.a.createElement("div",null,i.a.createElement(b.a,{size:36,className:"loading"}),i.a.createElement("iframe",{src:r[t].link})),t&&!s&&i.a.createElement("p",{className:"error"},"Resource not found"),!t&&!n&&i.a.createElement("div",null,a&&i.a.createElement("div",{className:"wrapEdit"},i.a.createElement(f.a,{href:"/resource?edit"},i.a.createElement("button",{id:"edit"},"Edit resources"))),u&&i.a.createElement(b.a,{size:36}),c&&!u&&i.a.createElement("p",{className:"error"},c),!u&&!l.length&&i.a.createElement("p",{className:"error"},"There are items here yet"),i.a.createElement(d.a,{items:l.map(function(e){return{label:r[e].label,link:"/resource?id=".concat(e)}})})))}}]),r}();t.default=Object(m.a)(Object(l.b)(function(e){return{resources:e.resources,users:e.users}})(z),function(e){return{query:e.query}})}},[511]).default}});