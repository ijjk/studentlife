module.exports=__NEXT_REGISTER_PAGE("/page",function(){return{page:webpackJsonp([3],{177:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(2),i=(n.n(o),n(6)),l=n(3),c=n(4),u=(n.n(c),n(16)),s=n.n(u),p=n(59);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){d(e,t,n[t])})}return e}({padding:10,width:"100%"},l.flexRowCenter,{alignItems:"flex-start","& img":{width:96,maxHeight:96,margin:"0 10px 0 0"},"& p":{wordBreak:"break-word",maxWidth:l.sizes.maxBlockWidth,"& span":{fontWeight:700}},"& a":{textDecoration:"none"}});t.a=Object(i.b)(function(e){return{pages:e.pages}})(function(e){var t=e.canEdit,n=e.pages,r=n.curPage,i=n[r]||{},l=i.desc,u=i.name,d=i.thumb,m=r===c.newsPageId?"/news?edit":"/page?id="+r+"&edit";return d?a.a.createElement("div",{className:Object(o.css)(f)},a.a.createElement(p.a,{_id:r,thumb:d}),a.a.createElement("div",null,a.a.createElement("p",null,a.a.createElement("span",null,u),t&&a.a.createElement(s.a,{href:m,passHref:!0},a.a.createElement("a",{id:"edit"}," - Edit"))),a.a.createElement("p",null,l))):null})},25:function(e,t,n){"use strict";var r=n(4),a=(n.n(r),r.allowedExts.images),o=r.allowedExts.other,i=Math.floor(r.maxFileSize/1e6)+"MB",l=function(e){return{error:e}};t.a=function(e){var t=e.file,n=e.customExtension,c=e.imageOnly,u=e.previewCb,s=t.name;if(t.size>r.maxFileSize)return l("File exceeds max file size of ".concat(i));if(s.indexOf(".")<0)return l("File name does not contain a file extension (e.g. .jpg, .png)");var p=s.split(".").pop().toLowerCase();if(n)return l(p===n?null:"File type is invalid. Expected .".concat(n));var d=a.indexOf(p)>-1;if(!d&&c||!d&&o.indexOf(p)<0)return function(e){var t=e?a:a.concat(o);return l("File type is invalid. Allowed types are ".concat(t.join(", "),"."))}(c);if(d&&"function"==typeof u){var f=new FileReader;f.onload=function(e){u(e.target.result)},f.readAsDataURL(t)}return{error:null}}},26:function(e,t,n){"use strict";var r=n(0),a=n.n(r);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}t.a=function(e){var t=e.children,n=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["children"]);return a.a.createElement("a",o({target:"_blank",rel:"noopener noreferrer"},n),t)}},27:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=["January","February","March","April","May","June","July","August","September","October","November","December"],a=function(e){return(e=e.split("-"))[1]=e[1].replace("0",""),e=e.join("-"),new Date(e)};t.a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e=e instanceof Date?e:new Date(e);var n,a="".concat(r[e.getMonth()]," ").concat(e.getDate(),", ").concat(e.getFullYear());if(!t){var o="AM",i=e.getHours(),l=e.getMinutes();i>11?(i=i>12?i-12:i,o="PM"):0===i&&(i="12"),n=l,l=1===(n+="").length?"0"+n:n,a+=" ".concat(i,":").concat(l," ").concat(o)}return a}},33:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(2),i=n(6),l=n(1),c=n(13),u=n(4),s={top:0,left:0,zIndex:5,opacity:0,height:"0",width:"100%",color:"#ffffff",position:"fixed",overflow:"hidden",background:"rgba(0, 0, 0, 0.75)",transition:"opacity 175ms ease-in-out","&.active":{opacity:1,height:"100%"},"& .close":{top:15,right:25,fontSize:35,cursor:"pointer",position:"absolute"},"& img":{top:0,left:0,right:0,bottom:0,margin:"auto",maxWidth:"90%",maxHeight:"90%",position:"absolute"}},p=function(e){var t=e.posts;return a.a.createElement("div",{className:Object(o.css)(s)+(t.expanded?" active":"")},a.a.createElement("div",{id:"escape",className:"close",onClick:l._24,title:"Hide expanded view"},"X"),t.expanded?a.a.createElement("img",{src:u.uploadsUrl+t[t.expanded].file,alt:"expanded post image"}):null)},d=n(3),f=n(15),m=n(16),b=n.n(m),g=n(7),h=n(26);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w={width:"100%",textAlign:"center",margin:"10px 0","& img":{width:"auto",height:"auto",maxHeight:400,maxWidth:"98%",cursor:"pointer"},"& a":function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){v(e,t,n[t])})}return e}({fontSize:15},d.flexRowCenter,{display:"inline-flex",padding:"8px 10px",margin:"10px 5px 0",textDecoration:"none","& svg":{marginRight:5},"& span":{height:16}})},O={height:16,width:16},x=function(e){var t=e._id,n=e.file;return a.a.createElement("div",{className:Object(o.css)(w)},function(){var e="file",r=n.split(".").pop();if(u.allowedExts.images.indexOf(r)>-1)return a.a.createElement("img",{src:u.uploadsUrl+n,onClick:function(){return Object(l._42)(t)}});switch(r){case"pdf":e+="-pdf";break;case"xls":case"xlsx":e+="-excel";break;case"doc":case"docx":e+="-word";break;case"ppt":case"pptx":e+="-powerpoint"}return a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(g.a,y({icon:e},{style:{height:72,width:72,color:"#555555"}}))),a.a.createElement(h.a,{href:u.uploadsUrl+n,download:!0,className:"btn"},a.a.createElement(g.a,{icon:"download",style:O}),a.a.createElement("span",null,"Download")),a.a.createElement(h.a,{href:"https://docs.google.com/viewer?url="+u.uploadsUrl+n,className:"btn"},a.a.createElement(g.a,{icon:"eye",style:O}),a.a.createElement("span",null,"View")))}())};function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E={width:"100%",textAlign:"center",padding:"5px 0 15px",wordBreak:"break-word","& textarea":{padding:5,width:"100%",border:"none",marginBottom:10,borderBottom:"1px solid ".concat(d.colors.grey)},"& .buttons":function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){j(e,t,n[t])})}return e}({width:"100%"},d.flexRowCenter,{justifyContent:"center","& button":{margin:"0 5px"}})},P=function(e){var t=e._id,n=e.commentId;return"edit"+(n?"Comment"+n:"Post"+t)},_=function(e){var t=e._id,n=e.commentId;if(n)return Object(l._27)({post:t,_id:n,editing:!1});Object(l._71)({_id:t,editing:!1})},k=function(e){var t=e._id,n=e.commentId,r=e.editing,i=e.text,c=P({_id:t,commentId:n});return a.a.createElement("div",{className:Object(o.css)(E)},r?a.a.createElement("div",null,a.a.createElement("textarea",{autoFocus:!0,id:c,defaultValue:i,maxLength:u.maxPostText}),a.a.createElement("div",{className:"buttons"},a.a.createElement("button",{onClick:function(){return function(e){var t,n,r,a=e._id,o=e.commentId;_({_id:a,commentId:o});var i=document.querySelector("#"+P({_id:a,commentId:o}));i&&(i=i.value.trim()).length&&(o?(t="comment",n=l._90,r={post:a,_id:o,text:i}):(t="post",n=l._94,r={_id:a,text:i}),n(r).catch(function(){Object(l._88)({title:"Error...",message:"An error occurred updating this ".concat(t,". Please try again later"),button1Txt:"OK",button2Txt:null})}))}({_id:t,commentId:n})}},"Submit"),a.a.createElement("button",{onClick:function(){return _({_id:t,commentId:n})},className:"btn-alt"},"Cancel"))):i)},S=n(22);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?A(e):t}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I={position:"relative","& svg":{cursor:"pointer"},"& .options":function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){T(e,t,n[t])})}return e}({top:0,right:30,height:0,width:115,zIndex:3},d.shadows.box,{borderRadius:3,overflow:"hidden",position:"absolute",background:"#ffffff",transition:"height 150ms ease-in-out","&.active":{height:"auto",minHeight:25},"& .opt":{padding:"4px 0",cursor:"pointer",userSelect:"none",textAlign:"center",borderBottom:"1px solid ".concat(d.colors.grey),":hover":{background:d.colors.grey}}})},M=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return D(r,(n=r=D(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),Object.defineProperty(A(r),"state",{configurable:!0,enumerable:!0,writable:!0,value:{show:!1}}),Object.defineProperty(A(r),"toggleShow",{configurable:!0,enumerable:!0,writable:!0,value:function(){return r.setState({show:!r.state.show})}}),Object.defineProperty(A(r),"askAndDo",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=e.message,n=e.errMessage,a=e.toDo;r.toggleShow(),Object(l._88)({message:t,button1Act:function(){a().catch(function(){Object(l._88)({title:"Error...",message:n,button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(A(r),"report",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=r.props,t=e._id,n=e.commentId,a=n?"comment":"post";r.askAndDo({message:"Are you sure you want to report this ".concat(a,"?"),errMessage:"An error occurred reporting the ".concat(a),toDo:n?function(){return Object(l._90)({_id:n,reported:!0})}:function(){return Object(l._94)({_id:t,reported:!0})}})}}),Object.defineProperty(A(r),"unreport",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=r.props,t=e._id,n=e.commentId;r.askAndDo({message:"Are you sure you want to dismiss this reporting?",errMessage:"An error occurred dismissing the reporting",toDo:n?function(){return Object(l._90)({_id:n,reported:!1})}:function(){return Object(l._94)({_id:t,reported:!1})}})}}),Object.defineProperty(A(r),"archive",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=r.props,t=e._id,n=e.commentId,a=e.users,o=a[a.curUser].isAdmin?"archive":"delete",i=o.substr(0,o.length-1)+"ing",c=n?"comment":"post";r.askAndDo({message:"Are you sure you want to ".concat(o," this ").concat(c,"?"),errMessage:"An error occurred ".concat(i," this ").concat(c),toDo:n?function(){return Object(l._90)({_id:n,archived:!0})}:function(){return Object(l._94)({_id:t,archived:!0})}})}}),Object.defineProperty(A(r),"edit",{configurable:!0,enumerable:!0,writable:!0,value:function(){r.toggleShow();var e=r.props,t=e._id,n=e.commentId;if(n)return Object(l._27)({post:t,_id:n,editing:!0});Object(l._71)({_id:t,editing:!0})}}),Object.defineProperty(A(r),"delete",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=r.props,t=e._id,n=e.commentId,a=n?"comment":"post";r.askAndDo({message:"Are you sure you want to delete this ".concat(a,". This can not be undone."),errMessage:"An error occurred while deleting this ".concat(a),toDo:n?function(){return Object(l._75)(n)}:function(){return Object(l._82)(t)}})}}),Object.defineProperty(A(r),"shouldHide",{configurable:!0,enumerable:!0,writable:!0,value:function(e){r.mainEl&&!r.mainEl.contains(e.target)&&r.setState({show:!1})}}),n))}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,(i=[{key:"componentDidMount",value:function(){window.addEventListener("click",this.shouldHide)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.shouldHide)}},{key:"render",value:function(){var e=this,t=this.props,n=t.reported,r=t.archived,i=t.createdBy,l=t.users,c=this.state.show,u=l[l.curUser].isAdmin,s=Boolean(i===l.curUser),p="Report",d=this.report;return n&&(d=u?this.unreport:null,p=u?"Dismiss report":"Reported"),a.a.createElement("div",{className:Object(o.css)(I)+" PostOptions",ref:function(t){return e.mainEl=t}},a.a.createElement(g.a,{icon:"ellipsis-v",style:{height:20,width:15},onClick:this.toggleShow}),a.a.createElement("div",{className:"options"+(c?" active":"")},r&&n||!r&&a.a.createElement("div",{onClick:d,className:"opt"},p),r||!s&&!u?null:a.a.createElement("div",{onClick:this.edit,className:"opt",id:c?"edit":null},"Edit"),r||!s&&!u?null:a.a.createElement("div",{className:"opt",onClick:this.archive,id:!u&&c?"delete":null},u?"Archive":"Delete"),u?a.a.createElement("div",{className:"opt",onClick:this.delete,id:u&&c?"delete":null},"Delete"):null))}}])&&N(n.prototype,i),c&&N(n,c),t}(),F=n(27),R={width:"100%",display:"flex",paddingBottom:5,position:"relative","& .text":{fontSize:15,marginLeft:5,position:"relative",wordWrap:"break-word",width:"calc(100% - 55px)","& .name":{fontWeight:700,paddingBottom:1,width:"calc(100% - 30px)","& a":{textDecoration:"none"}},"& .PostOptions":{top:0,right:0,padding:"8px 2px",position:"absolute"}}},B=function(e){var t=e._id,n=e.commentId,r=e.users,i=e.createdBy,l=e.createdAt,c=e.reported,u=e.archived,s=r[i]||{},p=s.avatar,d=s.firstName,f=s.lastName,m=s.username;return a.a.createElement("div",{className:Object(o.css)(R)},a.a.createElement(S.a,{avatar:p,style:{height:50,width:50,borderRadius:50}}),a.a.createElement("div",{className:"text"},a.a.createElement("p",{className:"name"},a.a.createElement(b.a,{href:"/user?id="+i},a.a.createElement("a",null,d," ",f," - @",m))),a.a.createElement("p",null,Object(F.a)(l)),a.a.createElement(M,{_id:t,commentId:n,reported:c,archived:u,createdBy:i,users:r})))},W={paddingTop:5,width:"98%",margin:"0 0 0 2%",position:"relative",background:"#ffffff",borderTop:"1px solid ".concat(d.colors.blackFg)},L=function(e){var t=e._id,n=e.text,r=e.users,i=e.editing,l=e.archived,c=e.reported,u=e.commentId,s=e.createdAt,p=e.createdBy;return a.a.createElement("div",{className:Object(o.css)(W)},a.a.createElement(B,{_id:t,commentId:u,users:r,createdAt:s,createdBy:p,reported:c,archived:l}),a.a.createElement(k,{_id:t,commentId:u,editing:i,text:n}))};function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){U(e,t,n[t])})}return e}({width:"100%"},d.shadows.box,{margin:"10px 0 0",borderRadius:3},d.flexRowCenter,{background:"#ffffff","& textarea":{height:24,outline:0,padding:"3px 8px",flexGrow:1,fontSize:16,lineHeight:1,border:"none",marginRight:2},"& button":{margin:3}}),H=function(e){var t=e._id;return a.a.createElement("div",{className:Object(o.css)(z)},a.a.createElement("textarea",{id:"reply"+t,maxLength:u.maxCmntText,placeholder:"Reply to the post..."}),a.a.createElement("button",{onClick:function(){return function(e){var t=document.querySelector("#reply"+e);if(t){var n=t.value.trim();n.length&&(t.value="",Object(l._32)({postId:e,text:n}).catch(function(){Object(l._88)({title:"Error...",message:"An error occurred while submitting your reply",button1Txt:"OK",button2Txt:null})}))}}(t)}},"Submit"))};function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(){return(K=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?V(e):t}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){Y(e,t,n[t])})}return e}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Z={"& .loadOlders":X({marginBottom:5,padding:"2px 0",fontWeight:700},d.flexRowCenter,{cursor:"pointer",textAlign:"right",userSelect:"none"}),"& .error":{padding:"10px 0",textAlign:"center"}},Q=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return J(r,(n=r=J(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),Object.defineProperty(V(r),"loadMoreComments",{configurable:!0,enumerable:!0,writable:!0,value:function(){return Object(l._47)({postId:r.props._id})}}),n))}var n,i,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,(i=[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t._id,r=t.commentIds,a=t.commentsError,o=t.commentsPending,i=t.moreComments;e.commentIds.length&&(r.length||o||a||!i||Object(l._47)({initial:!0,postId:n}))}},{key:"render",value:function(){var e=this.props,t=e._id,n=e.users,r=e.canReply,i=e.comments,l=e.commentIds,u=e.moreComments,s=e.commentsError,p=e.commentsPending;return a.a.createElement("div",{className:Object(o.css)(Z),style:{marginTop:u?0:10}},u?a.a.createElement("div",{className:"loadOlders",onClick:p?null:this.loadMoreComments},a.a.createElement("p",{style:{marginLeft:"auto"}},"Load older comments"),p?a.a.createElement(c.a,{size:16,style:{margin:"0 5px"}}):a.a.createElement(g.a,{icon:"chevron-up",style:{height:16,margin:"0 0 -2px 5px"}})):null,l.map(function(e,r){return a.a.createElement(L,K({},X({_id:t,users:n,commentId:e},i[e],{style:0===r?{borderColor:"transparent"}:null}),{key:e}))}),s?a.a.createElement("p",{className:"error"},s):null,r&&a.a.createElement(H,{_id:t}))}}])&&q(n.prototype,i),u&&q(n,u),t}();function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ee={opacity:0,width:"100%",textAlign:"left",transform:"scale(0)",margin:"0px auto 35px",maxWidth:d.sizes.maxBlockWidth,animation:"".concat(f.f," 225ms ease forwards"),":nth-child(1)":{marginTop:0},"& .page":{minHeight:16,fontWeight:700,padding:"5px 0","& a":{textDecoration:"underline"}},"& .box":{minHeight:75,borderRadius:4,background:"#ffffff",boxShadow:"3px 3px 6px rgba(0, 0, 0, 0.25)"},"& .totalComments":{width:"100%",padding:"0px 5px 5px","& span":{fontWeight:700,cursor:"pointer"}}},te=function(e){var t=e._id,n=e.text,r=e.file,o=e.page,i=e.users,c=e.pages,s=e.style,p=e.editing,d=e.reported,f=e.archived,m=e.createdAt,g=e.createdBy,h=e.className,y=e.commentIds,v=e.totalComments,w=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,["_id","text","file","page","users","pages","style","editing","reported","archived","createdAt","createdBy","className","commentIds","totalComments"]);return a.a.createElement("div",{className:h,style:s},a.a.createElement("p",{className:"page"},c.curPage!==o?a.a.createElement(b.a,{href:o===u.newsPageId?"/news":"/page?id="+o},a.a.createElement("a",null,"Posted to ",c[o].name)):c.curPage===u.homePageId&&"Posted to Home"),a.a.createElement("div",{className:"box"},a.a.createElement(B,{users:i,_id:t,createdBy:g,createdAt:m,reported:d,archived:f}),r&&a.a.createElement(x,{file:r,_id:t}),a.a.createElement(k,{_id:t,editing:p,text:n}),a.a.createElement("div",{className:"totalComments"},a.a.createElement("p",null,v," comment",1!==v?"s":"",y&&y.length>l._59&&[" - ",a.a.createElement("span",{key:"collapse",onClick:function(){return Object(l._23)(t)}},"Collapse comments")]))),a.a.createElement(Q,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){$(e,t,n[t])})}return e}({_id:t,users:i,canReply:!f,totalComments:v,commentIds:y},w)))};function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var le={width:"100%",textAlign:"center",padding:10,paddingBottom:25,"& .moreBtn":{margin:"10px auto"}},ce=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(r=(t.__proto__||Object.getPrototypeOf(t)).call(this))||"object"!==ne(r)&&"function"!=typeof r?ie(n):r,Object.defineProperty(ie(e),"loadMorePosts",{configurable:!0,enumerable:!0,writable:!0,value:function(){return Object(l._51)({})}}),e.state={numAdded:0,numPrev:0},e.className=Object(o.css)(le),e.postClass=Object(o.css)(ee),e}var n,i,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,u=[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.numPrev,r=e.posts.ids.length;return r!==n?{numPrev:r,numAdded:r>n?r-n:0}:null}}],(i=[{key:"componentDidUpdate",value:function(e){var t=this.props.posts;e.posts.ids.length&&(t.ids.length||t.pending||t.error||!t.hasMore||this.loadMorePosts())}},{key:"render",value:function(){var e=this,t=this.props,n=t.page,r=t.pages,o=t.posts,i=t.users,l=this.state.numAdded,u=o.ids.length-l;return n!==r.curPage?null:a.a.createElement("div",{className:this.className},a.a.createElement(p,{posts:o}),o.ids.map(function(t,n){return l&&(n=n>u?n-u:0),a.a.createElement(te,re({},function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ae(e,t,n[t])})}return e}({},o[t],{_id:t,pages:r,users:i,className:e.postClass,style:{animationDelay:50*n+"ms"}}),{key:t}))}),!o.ids.length&&!o.pending&&!o.error&&a.a.createElement("p",null,"There are no posts here yet"),o.error&&a.a.createElement("p",{style:{marginTop:20}},o.error),o.pending&&a.a.createElement(c.a,{style:{marginTop:20},size:o.ids.length?24:36}),o.hasMore&&!o.pending&&a.a.createElement("button",{className:"moreBtn",onClick:this.loadMorePosts},"Load more"))}}])&&oe(n.prototype,i),u&&oe(n,u),t}();t.a=Object(i.b)(function(e){return{pages:e.pages,posts:e.posts,users:e.users}})(ce)},42:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(10),i=(n.n(o),n(2)),l=(n.n(i),n(25)),c=n(1),u=n(3),s=n(15);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={padding:10,width:"100%",minHeight:80,overflow:"hidden",position:"relative",maxWidth:u.sizes.maxBlockWidth,border:"1px dotted ".concat(u.colors.blackFg),"& .select":b({},u.flexColCenter,{textAlign:"center",justifyContent:"center","& input":{display:"none"},"& button":{margin:10}}),"& .eatAnim":{width:60,height:60,position:"absolute",transform:"rotate(-30deg)",animation:"".concat(Object(s.b)(60)," 2.5s ease-in-out infinite"),"& .half":{width:60,height:30,overflow:"hidden",textAlign:"center","& div":{width:60,height:60,borderRadius:60,background:u.colors.yellow},":nth-child(1)":{position:"relative",animation:"".concat(s.c," 600ms ease-in-out infinite"),"& i":{top:10,left:24,width:8,height:8,borderRadius:8,background:"black",position:"absolute"}},":nth-child(2)":{animation:"".concat(s.a," 600ms ease-in-out infinite")}}}},y=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=(t.__proto__||Object.getPrototypeOf(t)).call(this),e=!r||"object"!==p(r)&&"function"!=typeof r?m(n):r,Object.defineProperty(m(e),"doFileCheck",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=e.props,r=n.checkFileParams,a=n.onFileChange;if(t){var o=Object(l.a)(b({},r,{file:t}));if(o.error)return Object(c._88)({title:"Error...",message:o.error,button1Txt:"OK",button2Txt:null})}"function"==typeof a&&a(t)}}),Object.defineProperty(m(e),"handleChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.target.files,r=n.length?n[0]:null;e.doFileCheck(r)}}),Object.defineProperty(m(e),"handleDrop",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({fileIncoming:!1});var n=t.dataTransfer.files;n.length&&(e.doFileCheck(n[0]),t.preventDefault())}}),Object.defineProperty(m(e),"handleDragOver",{configurable:!0,enumerable:!0,writable:!0,value:function(t){t.preventDefault(),clearTimeout(e.timeout),e.setState({fileIncoming:!0})}}),Object.defineProperty(m(e),"handleDragLeave",{configurable:!0,enumerable:!0,writable:!0,value:function(){clearTimeout(e.timeout),e.timeout=setTimeout(function(){e.setState({fileIncoming:!1})},100)}}),Object.defineProperty(m(e),"focusInput",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.fileEl&&e.fileEl.click()}}),e.state={fileIncoming:!1},e.className=Object(i.css)(h),e}var n,o,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,(o=[{key:"render",value:function(){var e=this,t=this.state.fileIncoming,n=this.props,r=n.style,o=n.message;return o=o||"Drag and drop file or click below to select",a.a.createElement("div",d({style:r},{className:this.className,onDrop:this.handleDrop,onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave}),t?a.a.createElement("div",{className:"eatAnim"},a.a.createElement("div",{className:"half"},a.a.createElement("div",null,a.a.createElement("i",null))),a.a.createElement("div",{className:"half"},a.a.createElement("div",null))):a.a.createElement("div",{className:"select"},a.a.createElement("p",null,t?"incoming!!!!":o),a.a.createElement("input",{type:"file",onChange:this.handleChange,ref:function(t){return e.fileEl=t}}),a.a.createElement("button",{onClick:this.focusInput},"Select file")))}}])&&f(n.prototype,o),u&&f(n,u),t}();t.a=y},509:function(e,t,n){e.exports=n(510)},510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,a=n(14),o=n.n(a),i=n(0),l=n.n(i),c=n(6),u=n(1),s=n(18),p=n(81),d=n(177),f=n(82),m=n(33),b=n(2),g=n(4),h=n(15),y=n(3),v=n(16),w=n.n(v),O=n(13);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){k(e,t,n[t])})}return e}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S={padding:10,"& .wrapNew":{paddingBottom:10,textAlign:"right"},"& .pages":{"& .error, & .pending":{marginTop:25,textAlign:"center"},"& .items":_({padding:"25px 10px"},y.flexRowCenter,{flexWrap:"wrap","& a":{textDecoration:"none"},"& div":(r={margin:20,width:140,cursor:"pointer",opacity:0,animation:"".concat(h.f," 150ms ease-in-out forwards"),":hover":{"& img":{boxShadow:"3px 6px 9px rgba(0, 0, 0, 0.3)"}},"& img":_({width:140,height:140},y.shadows.box,{borderRadius:"100%",background:"#ffffff",transition:"box-shadow 150ms ease-in-out"}),"& .name":{paddingTop:5,textAlign:"center",wordBreak:"break-word"}},k(r,y.media.lessThan(400),{width:115,"& img":{width:115,height:115}}),k(r,y.media.lessThan(350),{width:100,"& img":{width:100,height:100}}),r)}),"& .moreBtn":{margin:"0 auto 15px",display:"block"}}},C=function(e){var t=e.target.value;Object(u._45)({sort:t,initial:!0})},N=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return E(r,(n=r=E(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),Object.defineProperty(P(r),"state",{configurable:!0,enumerable:!0,writable:!0,value:{numPrev:0,numAddded:0}}),n))}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),n=t,a=[{key:"getDerivedStateFromProps",value:function(e,t){var n=t.numPrev,r=e.pages.toList.length;return r!==n?{numPrev:r,numAdded:r>n?r-n:0}:null}}],(r=[{key:"render",value:function(){var e=this.state.numAdded,t=this.props,n=t.pages,r=t.users,a=n.error,o=n.hasMore,i=n.pending,c=n.sort,s=n.toList,p=s.length-e,d=(r[r.curUser]||{}).restricts;return l.a.createElement("div",{className:Object(b.css)(S)},l.a.createElement("div",{className:"wrapNew"},d&&!d.making_pages?l.a.createElement(w.a,{href:"/new-page"},l.a.createElement("a",{id:"create"},l.a.createElement("button",null,"Create page"))):l.a.createElement("p",null,"Making pages is disabled for your account")),l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"sort"},"Sort pages: "),l.a.createElement("select",{id:"sort",value:c,onChange:C},l.a.createElement("option",{value:"createdAt:-1"},"Created new -> old"),l.a.createElement("option",{value:"createdAt:1"},"Created old -> new"),l.a.createElement("option",{value:"name:1"},"Name A -> Z"),l.a.createElement("option",{value:"name:-1"},"Name Z -> A"))),l.a.createElement("div",{className:"pages"},l.a.createElement("div",{className:"items"},s.map(function(t,r){var a=n[t]||{},o=a.name,i=a.thumb;return i?(e&&(r=r>p?r-p:0),l.a.createElement(w.a,{href:"/page?id=".concat(t),key:t},l.a.createElement("a",null,l.a.createElement("div",{style:{animationDelay:50*r+"ms"}},l.a.createElement("img",{src:g.uploadsUrl+i,alt:"page thumb"}),l.a.createElement("h6",{className:"name"},o))))):null})),!i&&!a&&!s.length&&l.a.createElement("p",{className:"error"},"There are no pages yet"),i&&l.a.createElement(O.a,{size:36,className:"pending"}),a&&!i&&l.a.createElement("p",{className:"error"},a),o&&!i&&l.a.createElement("button",{className:"moreBtn",onClick:function(){return Object(u._45)({})}},"Load more")))}}])&&j(n.prototype,r),a&&j(n,a),t}(),D=Object(c.b)(function(e){return{pages:e.pages,users:e.users}})(N),A=n(37);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function F(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}var R=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),F(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}var n,r,a,c,b;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["Component"]),n=t,r=[{key:"render",value:function(){var e=this.props,t=e.editMode,n=e.page,r=e.pages,a=e.users,o=Boolean(r[n]),i=(a[a.curUser]||{}).isAdmin,c=(r[n]||{}).createdBy,u={canEdit:i||c===a.curUser};return l.a.createElement(s.a,{restrict:!0},o&&t&&l.a.createElement(f.a,I({},u,{curPage:n})),o&&!t&&l.a.createElement("div",null,l.a.createElement(d.a,u),l.a.createElement(p.a,{page:n}),l.a.createElement(m.a,I({},u,{page:n}))),!o&&n&&l.a.createElement("p",{className:"errMsg"},"Page could not be found"),!n&&l.a.createElement(D,null))}}],a=[{key:"getInitialProps",value:(c=o.a.mark(function e(t){var n,r,a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.query,r={},!(a=n.id)){e.next=13;break}return r.page=a,r.editMode=void 0!==n.edit,e.next=8,Object(u._89)(a);case 8:if(r.editMode){e.next=11;break}return e.next=11,Object(u._51)({initial:!0});case 11:e.next=15;break;case 13:return e.next=15,Object(u._45)({initial:!0});case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}},e,this)}),b=function(){var e=this,t=arguments;return new Promise(function(n,r){var a=c.apply(e,t);function o(e,t){try{var o=a[e](t),c=o.value}catch(e){return void r(e)}o.done?n(c):Promise.resolve(c).then(i,l)}function i(e){o("next",e)}function l(e){o("throw",e)}i()})},function(e){return b.apply(this,arguments)})}],r&&M(n.prototype,r),a&&M(n,a),t}();t.default=Object(A.a)(Object(c.b)(function(e){return{pages:e.pages,users:e.users}})(R),function(e){return{query:e.query}})},81:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(6),i=n(2),l=(n.n(i),n(3)),c=n(7),u=n(1),s=n(4),p=(n.n(s),n(25));function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?b(e):t}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){h(e,t,n[t])})}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y={width:"100%",textAlign:"center",padding:"30px 10px 10px","& .error":{padding:"0 0 15px"},"& .box":g({width:"100%"},l.shadows.box,{margin:"auto",borderRadius:3},l.flexRowCenter,{background:"#ffffff",maxWidth:l.sizes.maxBlockWidth}),"& .preview":{width:"100%",textAlign:"left",padding:"0 10px","& img":{maxHeight:125,maxWidth:"50%"}},"& textarea":{outline:0,height:36,flexGrow:1,border:"none",overflow:"hidden",background:"none",padding:"10px 8px",transition:"height 150ms ease-in-out","::placeholder":{opacity:1}},"& input":{display:"none"},"& .buttons":g({},l.flexRowCenter,{"& button":{margin:"5px 4px 5px auto",":nth-child(1)":{display:"none",marginLeft:4},"&:disabled":{"&:hover, &:active":g({},l.shadows.box)}}}),"& .box.expanded":{flexWrap:"wrap","& textarea":{height:72,width:"100%",overflow:"auto"},"& .buttons":{width:"100%","& p":{marginLeft:5,"& span":{fontWeight:700},"& svg":{marginLeft:5,cursor:"pointer"}},"& button":{":nth-child(1)":{display:"block"}}}}},v=function(e){function t(){var e,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return m(r,(n=r=m(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),Object.defineProperty(b(r),"state",{configurable:!0,enumerable:!0,writable:!0,value:{text:"",file:null,hasImg:!1,preview:null,pending:!1,expanded:!1}}),Object.defineProperty(b(r),"handleText",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return r.setState({text:e.target.value})}}),Object.defineProperty(b(r),"handleFile",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=e.target.files,n=t.length?t[0]:null;r.doFileCheck(n)}}),Object.defineProperty(b(r),"doFileCheck",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(r.setState({file:null,preview:null}),e){var t=Object(p.a)({file:e,previewCb:r.previewCb});if(t.error)return r.fileEl.value=null,Object(u._88)({title:"Error...",button1Txt:"OK",button2Txt:null,message:t.error})}r.setState({file:e})}}),Object.defineProperty(b(r),"previewCb",{configurable:!0,enumerable:!0,writable:!0,value:function(e){r.setState({preview:e})}}),Object.defineProperty(b(r),"expand",{configurable:!0,enumerable:!0,writable:!0,value:function(){clearTimeout(r.timeout),r.timeout=null,r.setState({expanded:!0})}}),Object.defineProperty(b(r),"stopShrink",{configurable:!0,enumerable:!0,writable:!0,value:function(e){"BUTTON"===e.target.tagName&&(r.timeout=setTimeout(function(){return r.timeout=null},50))}}),Object.defineProperty(b(r),"shrink",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=r.state,t=e.file,n=e.text;if(t||n||r.timeout)return clearTimeout(r.timeout),void(r.timeout=null);r.setState({expanded:!1})}}),Object.defineProperty(b(r),"addFile",{configurable:!0,enumerable:!0,writable:!0,value:function(){return r.fileEl.click()}}),Object.defineProperty(b(r),"removeFile",{configurable:!0,enumerable:!0,writable:!0,value:function(){r.fileEl.value=null,r.setState({file:null,preview:null}),setTimeout(function(){return r.shrink()},1)}}),Object.defineProperty(b(r),"submit",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=r.state,t=e.text,n=e.file;Object(u._37)({text:t,file:n})}}),Object.defineProperty(b(r),"handleDragOver",{configurable:!0,enumerable:!0,writable:!0,value:function(e){r.expand(),e.preventDefault(),clearTimeout(r.timeout),r.timeout=null}}),Object.defineProperty(b(r),"handleDragLeave",{configurable:!0,enumerable:!0,writable:!0,value:function(){clearTimeout(r.timeout),r.timeout=setTimeout(function(){r.timeout=null,r.shrink()},100)}}),Object.defineProperty(b(r),"handleDrop",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=e.dataTransfer.files;t.length&&(r.doFileCheck(t[0]),e.preventDefault())}}),n))}var n,o,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,l=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.post,r=n.pending,a=n.error;return!t.pending||r||a?t.pending!==r?{pending:r}:null:{text:"",file:null,preview:null,expanded:!1,pending:r}}}],(o=[{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e,t=this,n=this.props,r=n.users,o=n.post,l=this.state,u=l.expanded,p=l.file,d=l.text,f=l.preview;return p&&(e=p.name).length>16&&(e=e.substr(0,13)+"..."),a.a.createElement("div",{className:Object(i.css)(y)},o.error&&a.a.createElement("p",{className:"error"},o.error),r[r.curUser].restricts.posting?a.a.createElement("p",null,"Posting is disabled for your account"):a.a.createElement("div",{onDrop:t.handleDrop,onMouseDown:t.stopShrink,onDragOver:t.handleDragOver,onDragLeave:t.handleDragLeave,className:"box"+(u?" expanded":"")},a.a.createElement("textarea",{value:d,id:"PostBox",maxLength:s.maxPostText,placeholder:"What would you like to post?",onBlur:t.shrink,onFocus:t.expand,onChange:t.handleText}),a.a.createElement("input",{type:"file",onChange:t.handleFile,ref:function(e){return t.fileEl=e}}),f&&a.a.createElement("div",{className:"preview"},a.a.createElement("img",{src:f,alt:"attachment preview"})),a.a.createElement("div",{className:"buttons"},a.a.createElement("button",{onClick:t.addFile,title:"Drag and drop or click to attach file"},"Attach file"),e&&a.a.createElement("p",null,a.a.createElement("span",null,"File: "),e,a.a.createElement(c.a,{icon:"trash",style:{height:16},onClick:t.removeFile})),o.pending?a.a.createElement("button",{disabled:!0},o.progress+"%"):a.a.createElement("button",{onClick:t.submit},"Submit"))))}}])&&f(n.prototype,o),l&&f(n,l),t}();t.a=Object(o.b)(function(e){return{users:e.users,post:e.post}})(v)},82:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(2),i=n(6),l=n(1),c=n(24),u=n.n(c),s=n(13),p=n(22),d=n(7),f=function(e){var t=e.mods,n=e.users,r=e.newMod,o=e.addMod,i=e.modError,l=e.handleMod,c=e.removeMod,u=e.modPending;return a.a.createElement("div",{className:"mods"},a.a.createElement("div",{className:"wrap"},a.a.createElement("h5",null,"Page moderators"),a.a.createElement("p",{className:"note"},"Note: moderators are allowed to edit the page's name, desc, and thumbnail and post on the page."),a.a.createElement("div",{className:"items"},(!t||!t.length)&&a.a.createElement("p",{className:"none"},"No moderators have been added yet"),t&&t.map(function(e){var t=e._id,r=e.user,o=n[r]||{},i=o.avatar,l=o.firstName,u=o.lastName,s=o.username;return a.a.createElement("div",{key:t},a.a.createElement(p.a,{avatar:i,style:{height:30,width:30}}),a.a.createElement("p",null,"".concat(l," ").concat(u," - @").concat(s)),a.a.createElement(d.a,{id:t,"data-user":r,icon:"trash",style:{height:18},onClick:c}))})),a.a.createElement("div",{className:"addMod"},a.a.createElement("label",{htmlFor:"modUser"},"New moderator: "),a.a.createElement("input",{type:"text",id:"modUser",value:r,onChange:l,placeholder:"New mod's username"}),a.a.createElement("button",{onClick:u?null:o},u?a.a.createElement(s.a,{size:18,alt:!0}):"Submit"),i&&a.a.createElement("p",null,i))))},m=n(59),b=n(3);function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){h(e,t,n[t])})}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y={padding:10,"& .denied":{padding:10,textAlign:"center"},"& .wrapDel":{textAlign:"right",paddingTop:5},"& .fields, & .mods":{width:"100%",margin:"15px auto",maxWidth:b.sizes.maxBlockWidth+130},"& .fields":g({margin:"30px auto"},b.flexRowCenter,{flexWrap:"wrap","& img":{margin:"15px 30px 0 0",alignSelf:"flex-start"},"& .field":g({width:"100%",marginTop:15},b.flexRowCenter,{alignItems:"flex-start","& label":{margin:"5px 5px 0 0"},"& input, & textarea":{padding:5,flexGrow:1,minWidth:175,maxWidth:275,border:"none",background:"transparent",transition:"border-color 150ms ease",borderBottom:"1px solid ".concat(b.colors.blackFg)},"&.btns":g({},b.flexRowCenter,{"& button":{":nth-child(1)":{margin:"0 10px 0 auto"}}})})}),"& .mods":{"& .wrap":{maxWidth:b.sizes.maxBlockWidth},"& .note":{fontSize:14,marginTop:2,maxWidth:"80%"},"& .items":{margin:"15px 0","& .none":{textAlign:"center"},"& div":g({width:"100%"},b.flexRowCenter,{alignItems:"flex-start","& p":{flexGrow:1,padding:"2px 0 0 5px"},"& svg":{cursor:"pointer"}})},"& .addMod":g({},b.flexRowCenter,{flexWrap:"wrap","& label":{marginRight:5},"& input":{padding:5,flexGrow:1,flexShrink:1,minWidth:175,border:"none",background:"none",borderBottom:"1px solid ".concat(b.colors.blackFg)},"& button":{marginLeft:10},"& p":{marginTop:10}})}},v=n(11),w=n(42);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var _=function(e){var t=e.label,n=e.name,r=e.type,o=P(e,["label","name","type"]);return a.a.createElement("div",{className:"field"},t&&a.a.createElement("label",{htmlFor:n},t),a.a.createElement("textarea"===r?"textarea":"input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){E(e,t,n[t])})}return e}({name:n,id:n,type:"textarea"!==r?r:null},o)))},k={name:"",desc:"",thumb:null},S=function(e){var t=e.curPage,n=e.pages;return"new"!==t&&n[t]?n[t]:k},C=function(e){function t(e){var n,r,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,n=!(a=(t.__proto__||Object.getPrototypeOf(t)).call(this,e))||"object"!==O(a)&&"function"!=typeof a?j(r):a,N.call(j(n));var i=S(e),l=i.name,c=i.desc,u=i.thumb;return n.state={name:l,desc:c,thumb:u,newMod:"",file:null,changed:{},modError:null,modPending:!1,previewData:null},n.className=Object(o.css)(y),n}var n,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["Component"]),n=t,l=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.curPage,r=e.page,a=e.pages;if(!r.error&&!r.pending&&t.pending){var o=a[n]||{name:"",desc:""};return{name:o.name,desc:o.desc,changed:{},pending:r.pending}}return r.pending!==t.pending?{pending:r.pending}:null}}],(i=[{key:"render",value:function(){var e,t=this.state,n=t.desc,r=t.name,o=t.newMod,i=t.changed,l=t.modError,c=t.modPending,u=t.previewData,s=this.props,p=s.canEdit,b=s.curPage,g=s.page,h=s.pages,y=s.users,v=(y[y.curUser]||{}).isAdmin,O=g.error,x=g.pending,j=g.progress,E=h[b]||{},k=E.mods,S=E.modsOnly,C=E.thumb,N=P(E,["mods","modsOnly","thumb"]),D="new"===b,A=Object.keys(i).length;return b===h.curPage||D?p||D?(e=u?a.a.createElement(m.a,{src:u}):D?a.a.createElement(d.a,{icon:"file",style:{height:86,width:96,marginRight:25}}):a.a.createElement(m.a,{_id:h.curPage,thumb:C}),a.a.createElement("div",{className:this.className},v&&!N.default&&!D&&a.a.createElement("div",{className:"wrapDel"},a.a.createElement("button",{id:"delete",onClick:this.delete},"Delete page")),a.a.createElement("div",{className:"fields"},e,a.a.createElement(w.a,{style:{margin:"10px 0"},onFileChange:this.handleFileChange,checkFileParams:{imageOnly:!0,previewCb:this.previewThumb},message:"Drag and drop picture or click below to select page thumbnail"}),a.a.createElement(_,{name:"name",value:r,label:"Page name:",onChange:this.handleField,placeholder:"A name for the page"}),a.a.createElement(_,{name:"desc",value:n,type:"textarea",label:"Page description:",onChange:this.handleField,placeholder:"A description of the page"}),Boolean(D&&i.thumb&&i.name||!D&&A)&&a.a.createElement("div",{className:"field btns"},a.a.createElement("button",{onClick:this.reset,className:"btn-alt"},"Reset"),a.a.createElement("button",{onClick:x?null:this.submit},x?"".concat(j,"%"):"Submit")),O&&a.a.createElement("p",{className:"error"},O)),!D&&S&&v&&a.a.createElement(f,{mods:k,users:y,newMod:o,modError:l,modPending:c,addMod:this.addMod,handleMod:this.handleMod,removeMod:this.removeMod}))):a.a.createElement("div",{className:this.className},a.a.createElement("p",{className:"denied"},"You are not allowed to edit this page")):null}}])&&x(n.prototype,i),l&&x(n,l),t}(),N=function(){var e=this;Object.defineProperty(this,"handleFileChange",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n={changed:e.state.changed,file:t};t?n.changed.thumb=!0:(delete n.changed.thumb,n.previewData=null),e.setState(n)}}),Object.defineProperty(this,"handleField",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n,r=e.state.changed,a=t.target,o=a.name,i=a.value;i!==S(e.props)[o]?r[o]=!0:delete r[o],e.setState((E(n={},o,i),E(n,"changed",r),n))}}),Object.defineProperty(this,"reset",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=S(e.props),n=t.name,r=t.desc;e.setState({name:n,desc:r,file:null,changed:{},previewData:null})}}),Object.defineProperty(this,"submit",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.props.curPage,n=e.state,r=n.changed,a=n.file,o=n.name,i="new"===t;if(!i||o&&a){var c={},s=Object.keys(r);s.length&&(s.forEach(function(t){return c[t]=e.state[t]}),r.thumb&&(c.thumb=a,delete c.file),i||(c._id=t),Object(l._88)({message:"Are you sure you would like to ".concat(i?"create":"update"," this page?"),button1Act:function(){Object(l._93)(c).then(function(e){return u.a.push("/page?id="+e)})}}))}}}),Object.defineProperty(this,"previewThumb",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({previewData:t})}}),Object.defineProperty(this,"handleMod",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.setState({newMod:t.target.value})}}),Object.defineProperty(this,"addMod",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.state,n=t.newMod;t.modPending||(n=n.trim())&&Object(l._88)({message:"Are you sure you want to make ".concat(n," a moderator on this page?"),button1Act:function(){e.setState({modPending:!0,modError:null}),Object(l._34)(n).then(function(){e.setState({modPending:!1,newMod:""})}).catch(function(t){e.unmounted||e.setState({modPending:!1,modError:Object(v.a)(t,"An error occurred adding the mod")})})}})}}),Object.defineProperty(this,"removeMod",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.currentTarget,r=e.props.users,a=n.id,o=r[n.getAttribute("data-user")].username;Object(l._88)({message:"Are you sure you want to remove ".concat(o," as a moderator?"),button1Act:function(){Object(l._78)(a).catch(function(e){Object(l._88)({title:"Error...",message:Object(v.a)(e,"An error occurred removing the moderator"),button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(this,"delete",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.props.curPage;Object(l._88)({message:"Are you sure you want to delete this page? This will delete all posts too and is permanent.",button1Act:function(){Object(l._81)(t).then(function(){return u.a.push("/page")}).catch(function(e){Object(l._88)({title:"Error...",message:Object(v.a)(e,"An error occurred removing the page"),button1Txt:"OK",button2Txt:null})})}})}}),Object.defineProperty(this,"componentWillUnmount",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.unmounted=!0}})};t.a=Object(i.b)(function(e){return{page:e.page,pages:e.pages,users:e.users}})(C)}},[509]).default}});